---
title: "Project2"
author: "Gabriella Dauber"
date: "11/12/2021"
output: html_document
---

```{r}

##### Conditional #####

cbp1 <- c("midnightblue", "limegreen", "#E7B800", "deeppink1", "#00AFBB")

genretest <- function(genre.label){
  songs <- switch(genre.label,
                  "bigoom" = "midnightblue",
                  "edm" = "limegreen",
                  "hip hop & rap" = "E7B800",
                  "latin & reggaeton" = "deeppink1",
                  "pop" = "#00AFBB"
                  )
  return(songs)
}
genretest("pop")
genretest("edm")
```


```{r}

##### function #####

library(ggplot2)
top50 <- read.csv("top50cleanspotify.csv", encoding = "Windows-1252")
cbp1 <- c("midnightblue", "limegreen", "#E7B800", "deeppink1", "#00AFBB")

spotify.plot <- function(xpos, ypos){
  ggplot(top50, aes_string(x = xpos, y = ypos, color = "Genre", fill = "Genre")) + geom_point(size = 3) + xlab(sub("[.]", " ", xpos)) + ylab(sub("[.]", " ", ypos)) + scale_colour_manual(values=cbp1)
}

spotify.plot("Popularity", "Danceability")

```

```{r}

##### function #####

library(ggplot2)
top50 <- read.csv("top50cleanspotify.csv", encoding = "Windows-1252")
cbp1 <- c("midnightblue", "limegreen", "#E7B800", "deeppink1", "#00AFBB")

spotify.plot("Energy", "Beats.Per.Minute")

```


```{r}
#Conditional

cpb2 <- c("pop", "latin & reggaeton", "hip hop & rap", "edm", "big room")

artist.test <- function(artist.label){
  artist <- switch(artist.label,
                   "pop" = "Shawn Mendes", "Ariana Grande",
                   "latin & reggaeton" = "Anuel AA", 
                   "hip hop & rap" = "Post Malone", 
                   "edm" = "The Chainsmokers", 
                   "big room" = "Martin Garrix"
                   )
  return(artist)
}

artist.test("pop")
artist.test("edm")

```



```{r}
#dance conditional into spotify_plot function

top50 <- read.csv("top50cleanspotify.csv", encoding = "Windows-1252")


library(ggplot2)

top50$dance_bin <- ifelse(top50$Danceability > 70, "Dance", "Don't Dance") 

spotify_plot <- function(xpos, ypos){
  ggplot(top50, aes_string(x = xpos, y = ypos, color = "dance_bin")) + geom_point(size = 3) + xlab(sub("[.]", " ", xpos)) + ylab(sub("[.]", " ", ypos))
}

spotify_plot("Popularity", "Beats.Per.Minute")
ifelse(top50$Beats.Per.Minute > 100, "Dance", "Don't dance")


```

```{r}
# popularity condition in spotify_plot function

library(ggplot2)
top50 <- read.csv("top50cleanspotify.csv", encoding = "Windows-1252")
str(top50)

top50$Pop.bin <- ifelse(top50$Popularity >= 85, "Popular", "Unpopular")

spotify_plot <- function(xpos, ypos){
  ggplot(top50, aes_string(x = xpos, y = ypos, color = "Pop.bin")) + geom_point(size = 3) + xlab(sub("[.]", " ", xpos)) + ylab(sub("[.]", " ", ypos)) 
}

spotify_plot("Danceability", "Beats.Per.Minute")
spotify_plot("Popularity", "Danceability")

```


```{r}
library(ggplot2)
ggplot(top50, aes(top50, x = "Popularity", y = "Danceability", colour = Popularity >= 85)) + geom_point() +
  scale_colour_manual(name = 'Popularity > 85', values = setNames(c('red','green'),c(T, F))) +
  xlab('Popularity') + ylab('Danceability')
```



